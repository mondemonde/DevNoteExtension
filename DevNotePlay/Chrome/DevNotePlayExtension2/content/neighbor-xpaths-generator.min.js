window.neighborXpathsGenerator=window.neighborXpathsGenerator||{};neighborXpathsGenerator.excludedTags=["main","noscript","script","style","header","head","footer","meta","body","title","ul","iframe","link","svg","path","nav","p","option","br"];neighborXpathsGenerator.getXpathsByNeighbors=function(clickedElement,xpathPrefix){var usefulNeighbors=neighborXpathsGenerator.getUsefulNeighbors(clickedElement,2,2);var newXpaths=[];for(var i=0;i<usefulNeighbors.length;i++){var thisUsefulNeighbor=usefulNeighbors[i];var partialPathToGetTagOffset;var correctPrefix;var correctOffsetByTagName;var newXPath;var partialPathToGetTextOffset="(.//*[normalize-space(text()) and normalize-space(.)="+neighborXpathsGenerator.getImmediateText(thisUsefulNeighbor)+"])";var correctOffsetByText=neighborXpathsGenerator.getCorrectOffset(thisUsefulNeighbor,partialPathToGetTextOffset);var neighborXpath=partialPathToGetTextOffset+"["+correctOffsetByText+"]";if(!neighborXpathsGenerator.isDescendant(thisUsefulNeighbor,clickedElement)){correctPrefix=neighborXpathsGenerator.getRelativePrefix(clickedElement,thisUsefulNeighbor);partialPathToGetTagOffset=neighborXpath+"/"+correctPrefix+"::"+clickedElement.tagName.toLowerCase();correctOffsetByTagName=neighborXpathsGenerator.getCorrectOffset(clickedElement,partialPathToGetTagOffset);newXPath=partialPathToGetTagOffset+"["+correctOffsetByTagName+"]"}else{partialPathToGetTagOffset=neighborXpath+"/"+clickedElement.tagName.toLowerCase();correctOffsetByTagName=neighborXpathsGenerator.getCorrectOffset(clickedElement,partialPathToGetTagOffset);newXPath=partialPathToGetTagOffset+"["+correctOffsetByTagName+"]"}if(xpathPrefix){newXpaths.push("xpath="+newXPath)}else{newXpaths.push(newXPath)}}return newXpaths};neighborXpathsGenerator.getXpathByLabelFor=function(clickedElement,xpathPrefix){var clickedElementIDAttrName=clickedElement.getAttribute("id");var clickedElementIDAttrValue=clickedElementIDAttrName&&clickedElementIDAttrName!==""?clickedElementIDAttrName.attrValue:null;var newXpath=[];if(clickedElementIDAttrValue){var labelForInputXPath="//label[@for='"+clickedElementIDAttrValue+"']";var labelForInput=neighborXpathsGenerator.getElementByXPath(labelForInputXPath);if(labelForInput){var anchorXPath="//label[normalize-space(text()) and normalize-space(.)="+neighborXpathsGenerator.getImmediateText(labelForInput)+"]";var correctOffsetByText=neighborXpathsGenerator.getCorrectOffset(labelForInput,anchorXPath);var newXPath="//*[@id=string("+anchorXPath+"["+correctOffsetByText+"]"+"/@for)]";if(xpathPrefix){return newXPath}else{return newXPath}}}};neighborXpathsGenerator.getUsefulNeighbors=function(clickedElement,explicitPrecedeLevel,explicitFollowLevel){var usefulElements=[];var allElements=document.getElementsByTagName("*");var precedeCounter=0;var followCounter=0;var precedeLimit=explicitPrecedeLevel?explicitPrecedeLevel:1;var followLimit=explicitFollowLevel?explicitFollowLevel:1;for(var i=0;i<allElements.length;i++){var thisElement=allElements[i];if(thisElement===clickedElement){for(var j=i-1;j>=0;j--){if(allElements[j]){var prevElement=allElements[j];if(neighborXpathsGenerator.usefulElement(prevElement)&&precedeCounter<precedeLimit){usefulElements.push(prevElement);precedeCounter++}}else break}for(var k=i+1;k<allElements.length;k++){if(allElements[k]){var nextElement=allElements[k];if(neighborXpathsGenerator.usefulElement(nextElement)&&followCounter<followLimit){usefulElements.push(nextElement);followCounter++}}else break}}}return usefulElements};neighborXpathsGenerator.getRelativePrefix=function(clickedElement,neighbor){var elementPath=neighborXpathsGenerator.getIndexPath(clickedElement);var neighborPath=neighborXpathsGenerator.getIndexPath(neighbor);for(var i=0;i<Math.max(elementPath.length,neighborPath.length);i++){if(elementPath[i]!=neighborPath[i]){return elementPath[i]-neighborPath[i]<0?"preceding":"following"}}};neighborXpathsGenerator.getCorrectOffset=function(clickedElement,xpath){var candidates=neighborXpathsGenerator.getElementsByXPath(xpath);var counter=0;if(xpath.includes("preceding")){for(var i=candidates.length-1;i>=0;i--){var thisElement=candidates[i];if(thisElement===clickedElement){return counter+1}else{counter++}}}else{for(var i=0;i<candidates.length;i++){var thisElement=candidates[i];if(thisElement===clickedElement){return counter+1}else{counter++}}}return counter+1};neighborXpathsGenerator.getImmediateText=function(element){var textNodePresence=$(element).contents().filter(function(){return this.nodeType==Node.TEXT_NODE}).text().trim();var text="";var addedSingleSpace=false;for(var i=0;i<element.childNodes.length;i++){if(element.childNodes[i].nodeType==Node.TEXT_NODE){if($(element.childNodes[i]).text().trim()==""){if(addedSingleSpace==false){text+=" ";addedSingleSpace=true}}else{text+=$(element.childNodes[i]).text().trim()}}}text=text.trim();if(textNodePresence){return neighborXpathsGenerator.generateConcatForXPath(text)}return""};neighborXpathsGenerator.generateConcatForXPath=function(string){var returnString="";var searchString=string.trim();var quotePos=neighborXpathsGenerator.getQuotePos(searchString);if(quotePos==-1){returnString="'"+searchString+"'"}else{returnString="concat(";while(quotePos!=-1){var subString=searchString.substring(0,quotePos);returnString+="'"+subString+"', ";if(searchString.substring(quotePos,quotePos+1)=="'"){returnString+='"\'", '}else{returnString+="'\"', "}searchString=searchString.substring(quotePos+1,searchString.length);quotePos=neighborXpathsGenerator.getQuotePos(searchString)}returnString+="'"+searchString+"')"}return returnString};neighborXpathsGenerator.getElementByXPath=function(path){return document.evaluate(path,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue};neighborXpathsGenerator.getElementsByXPath=function(path){var snapShotItems=document.evaluate(path,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);var ret=[];for(var i=0;i<snapShotItems.snapshotLength;i++){ret.push(snapShotItems.snapshotItem(i))}return ret};neighborXpathsGenerator.usefulElement=function(element){var elementXPathText=neighborXpathsGenerator.getImmediateText(element);var boundedQuotesRemoved=elementXPathText.substring(1,elementXPathText.length-1);return element&&!neighborXpathsGenerator.excludedTags.includes(element.tagName.toLowerCase())&&(neighborXpathsGenerator.getImmediateText(element)!=""&&neighborXpathsGenerator.getImmediateText(element).length>1&&neighborXpathsGenerator.getImmediateText(element).length<=100&&isNaN(parseInt(boundedQuotesRemoved)))&&element.getAttribute("type")!=="hidden"&&element.getAttribute("style")!=="display:none"&&element.getAttribute("aria-hidden")!=="true"&&element.getAttribute("href")!=="#"&&element.getAttribute("class")!=="hidden"};neighborXpathsGenerator.getIndexPath=function(domNode,bits){bits=bits?bits:[];var c=0;var p=domNode.parentNode;if(p){var els=p.children;if(els.length>1){while(els[c]!==domNode)c++}bits.push(c);return neighborXpathsGenerator.getIndexPath(p,bits)}return bits.reverse()};neighborXpathsGenerator.getAbsoluteXPath=function(domNode,bits){bits=bits?bits:[];var c=0;var b=domNode.nodeName;var p=domNode.parentNode;if(p){var els=p.getElementsByTagName(b);if(els.length>1){while(els[c]!==domNode)c++;b+="["+(c+1)+"]"}bits.push(b.toLowerCase());return neighborXpathsGenerator.getAbsoluteXPath(p,bits)}return bits.reverse().join("/")};neighborXpathsGenerator.getIndexPathsFromMatrix=function(matrix){var indexPaths=[];for(var i=0;i<matrix.length;i++){var thisElement=matrix[i];if(thisElement){indexPaths.push({element:thisElement,indexPath:neighborXpathsGenerator.getIndexPath(thisElement)})}}return indexPaths};neighborXpathsGenerator.getQuotePos=function(searchString){var ret1=searchString.indexOf("'");var ret2=searchString.indexOf('"');return ret1==-1?ret2:ret1};neighborXpathsGenerator.isDescendant=function(parent,child){var node=child.parentNode;while(node!=null){if(node==parent){return true}node=node.parentNode}return false};